# Отчёт по вычислительному заданию "Разностные схемы"

## Задание 1: Численное решение обыкновенного дифференциального уравнения

### Постановка задачи

Требуется найти численное решение уравнения:

$$y'(x) = f(x, y) = x \cdot y$$

на отрезке $[0, 1]$ с шагом $h = 0.1$ и начальным условием $y(0) = 1$.

Точное решение данной задачи Коши:

$$y(x) = e^{x^2/2}$$

### Используемые методы

#### 1. Метод Эйлера (схема "разность вперед")

Явная разностная схема первого порядка точности:

$$y_{n+1} = y_n + h \cdot f(x_n, y_n)$$

#### 2. Метод Рунге-Кутты третьего порядка

Более точная явная схема:

$$k_1 = h \cdot f(x_n, y_n)$$

$$k_2 = h \cdot f\left(x_n + \frac{h}{2}, y_n + \frac{k_1}{2}\right)$$

$$k_3 = h \cdot f(x_n + h, y_n + 2k_2 - k_1)$$

$$y_{n+1} = y_n + \frac{1}{6}(k_1 + 4k_2 + k_3)$$

### Результаты численного решения

| x   | Точное решение | Метод Эйлера | Ошибка Эйлера | Метод РК | Ошибка РК |
|-----|----------------|--------------|---------------|----------|-----------|
| 0.0 | 1.000000       | 1.000000     | 0.00e+00      | 1.000000 | 0.00e+00  |
| 0.1 | 1.005013       | 1.000000     | 5.01e-03      | 1.005017 | 4.15e-06  |
| 0.2 | 1.020201       | 1.010000     | 1.02e-02      | 1.020210 | 8.33e-06  |
| 0.3 | 1.046028       | 1.030200     | 1.58e-02      | 1.046041 | 1.27e-05  |
| 0.4 | 1.083287       | 1.061106     | 2.22e-02      | 1.083304 | 1.73e-05  |
| 0.5 | 1.133148       | 1.103550     | 2.96e-02      | 1.133171 | 2.22e-05  |
| 0.6 | 1.197217       | 1.158728     | 3.85e-02      | 1.197245 | 2.75e-05  |
| 0.7 | 1.277621       | 1.228251     | 4.94e-02      | 1.277654 | 3.31e-05  |
| 0.8 | 1.377128       | 1.314229     | 6.29e-02      | 1.377167 | 3.89e-05  |
| 0.9 | 1.499303       | 1.419367     | 7.99e-02      | 1.499347 | 4.45e-05  |
| 1.0 | 1.648721       | 1.547110     | 1.02e-01      | 1.648771 | 4.94e-05  |

### Оценка точности по методу Рунге

Метод Рунге позволяет численно определить порядок точности схемы и оценить погрешность без знания точного решения.

**Формула для оценки порядка точности:**

$$p = \log_2\left(\frac{|y_h - y_{h/2}|}{|y_{h/2} - y_{h/4}|}\right)$$

где $y_h$, $y_{h/2}$, $y_{h/4}$ — решения с шагами $h$, $h/2$ и $h/4$ соответственно.

**Формула для оценки погрешности:**

$$\varepsilon \approx \frac{|y_{h/2} - y_h|}{2^p - 1}$$

#### Метод Эйлера

**Численно оцененный порядок точности: p ≈ 0.96** (теоретически p = 1)

| x   | p (оценка) | Ошибка (известное) | Ошибка (по Рунге) |
|-----|------------|-------------------|-------------------|
| 0.0 | 0.0000     | 0.00e+00          | nan               |
| 0.1 | 0.9950     | 5.01e-03          | 2.52e-03          |
| 0.2 | 0.9870     | 1.02e-02          | 5.16e-03          |
| 0.3 | 0.9789     | 1.58e-02          | 8.07e-03          |
| 0.4 | 0.9707     | 2.22e-02          | 1.14e-02          |
| 0.5 | 0.9624     | 2.96e-02          | 1.53e-02          |
| 0.6 | 0.9539     | 3.85e-02          | 2.01e-02          |
| 0.7 | 0.9451     | 4.94e-02          | 2.60e-02          |
| 0.8 | 0.9361     | 6.29e-02          | 3.34e-02          |
| 0.9 | 0.9268     | 7.99e-02          | 4.28e-02          |
| 1.0 | 0.9171     | 1.02e-01          | 5.50e-02          |

#### Метод Рунге-Кутты

**Численно оцененный порядок точности: p ≈ 2.96** (теоретически p = 3)

| x   | p (оценка) | Ошибка (известное) | Ошибка (по Рунге) |
|-----|------------|-------------------|-------------------|
| 0.0 | 0.0000     | 0.00e+00          | nan               |
| 0.1 | 2.9923     | 4.15e-06          | 5.21e-07          |
| 0.2 | 2.9846     | 8.33e-06          | 1.05e-06          |
| 0.3 | 2.9769     | 1.27e-05          | 1.61e-06          |
| 0.4 | 2.9693     | 1.73e-05          | 2.20e-06          |
| 0.5 | 2.9616     | 2.22e-05          | 2.85e-06          |
| 0.6 | 2.9539     | 2.75e-05          | 3.55e-06          |
| 0.7 | 2.9459     | 3.31e-05          | 4.29e-06          |
| 0.8 | 2.9375     | 3.89e-05          | 5.07e-06          |
| 0.9 | 2.9285     | 4.45e-05          | 5.85e-06          |
| 1.0 | 2.9183     | 4.94e-05          | 6.54e-06          |

### Графики

![Результаты задания 1](task1_results.png)

**Описание графиков:**

1. **Верхний левый**: сравнение численных решений (Эйлер и РК) с точным решением
2. **Верхний средний**: абсолютная погрешность обоих методов (логарифмическая шкала)
3. **Верхний правый**: численная оценка порядка точности для обоих методов
4. **Нижний левый**: сравнение оценок погрешности для метода Эйлера
5. **Нижний средний**: сравнение оценок погрешности для метода Рунге-Кутты
6. **Нижний правый**: относительная ошибка оценки по методу Рунге

### Анализ результатов

1. **Порядок точности подтвержден экспериментально:**
   - Метод Эйлера: p ≈ 0.96 ≈ 1 (первый порядок)
   - Метод Рунге-Кутты: p ≈ 2.96 ≈ 3 (третий порядок)

2. **Погрешности:**
   - Метод Эйлера: ~10⁻¹ на конце отрезка
   - Метод Рунге-Кутты: ~10⁻⁵ на конце отрезка
   - Разница в точности составляет **примерно 2000 раз**

3. **Метод Рунге работает корректно:**
   - Оценка погрешности без знания точного решения дает результаты того же порядка величины
   - Относительная ошибка оценки составляет 10⁻¹ - 10⁰, что приемлемо для практических расчетов

4. **Вычислительная эффективность:**
   - При одинаковом числе шагов метод РК требует примерно в 3 раза больше вычислений функции f(x,y)
   - Но выигрыш в точности (×2000) многократно перекрывает эти затраты
   - Для достижения точности 10⁻⁵ методу Эйлера потребовался бы шаг h ≈ 0.00005, то есть **в 2000 раз больше вычислений**

### Выводы по заданию 1

1. **Метод Рунге успешно применён** для численной оценки порядка точности обоих методов. Полученные оценки (p ≈ 0.96 для Эйлера и p ≈ 2.96 для РК) отлично соответствуют теоретическим значениям.

2. **Метод Рунге-Кутты третьего порядка значительно превосходит** метод Эйлера по точности при сопоставимых вычислительных затратах. Для достижения той же точности методу Эйлера потребовалось бы на несколько порядков больше вычислений.

3. **Оценка погрешности по Рунге** при неизвестном точном решении работает надежно и дает результаты, согласующиеся с истинной погрешностью, что подтверждает практическую ценность этого подхода.

4. **Для решения ОДУ высокой точности** следует использовать методы высоких порядков (РК или выше), так как выигрыш в точности многократно превосходит дополнительные вычислительные затраты на шаг.

---

## Задание 2: Численное решение уравнения переноса

### Постановка задачи

Требуется найти численное решение линейного уравнения переноса:

$$\frac{\partial u}{\partial t} + a \frac{\partial u}{\partial x} = 0$$

при $a = 1$ на отрезке $[0, 10]$ с начальными условиями:

$$u(x, 0) = \begin{cases} 5, & x \leq 3 \\ 1, & x > 3 \end{cases}$$

Шаг по пространству: $h = 0.1$

Число Куранта: $r = \frac{a\tau}{h}$, где $\tau$ — шаг по времени

Граничные условия: $u(0, t) = 5$ (входящая волна слева)

Расчёты проводятся для $r \in \{0.25, 0.5, 1.0, 1.25\}$ на моменты времени $T \in \{0, 1, 5\}$

### Используемые методы

#### 1. Схема Годунова (явная односторонняя)

Разностная схема с односторонней разностью назад:

$$\frac{u_i^{n+1} - u_i^n}{\tau} + a\frac{u_i^n - u_{i-1}^n}{h} = 0$$

$$u_i^{n+1} = u_i^n - r(u_i^n - u_{i-1}^n)$$

**Свойства:**
- Явная схема первого порядка точности
- Условно устойчива: требуется $r \leq 1$ (условие Куранта-Фридрихса-Леви)
- При $r = 1$ дает точное решение для уравнения переноса
- Обладает численной диффузией (размазывание разрывов)

#### 2. Неявная симметричная схема

Разностная схема с центральной разностью:

$$\frac{u_i^{n+1} - u_i^n}{\tau} + a\frac{u_{i+1}^{n+1} - u_{i-1}^{n+1}}{2h} = 0$$

$$u_i^{n+1} - \frac{r}{2}(u_{i+1}^{n+1} - u_{i-1}^{n+1}) = u_i^n$$

**Свойства:**
- Неявная схема второго порядка точности
- Безусловно устойчива (устойчива при любых $r > 0$)
- Требует решения системы линейных уравнений на каждом временном шаге
- Обладает дисперсией (осцилляции на разрывах)

### Точное решение

Уравнение переноса имеет точное решение:

$$u(x, t) = u(x - at, 0)$$

Решение представляет собой перенос начального профиля вправо со скоростью $a = 1$ без искажений.

### Результаты расчётов

#### r = 0.25 (τ = 0.025)

| Время | Схема Годунова |           | Неявная схема |           |
|-------|----------------|-----------|---------------|-----------|
|       | L1-норма       | Макс.     | L1-норма      | Макс.     |
| T = 1 | 0.008576       | 1.758159  | 0.010813      | 2.023838  |
| T = 5 | 0.019310       | 1.891505  | 0.014972      | 2.057286  |

![Результаты для r = 0.25](task2_r_0_25.png)

**Наблюдения:**
- Схема Годунова показывает заметное размазывание разрыва (численная диффузия)
- Неявная схема дает осцилляции вблизи разрыва (эффект Гиббса)
- Обе схемы устойчивы

#### r = 0.5 (τ = 0.05)

| Время | Схема Годунова |           | Неявная схема |           |
|-------|----------------|-----------|---------------|-----------|
|       | L1-норма       | Макс.     | L1-норма      | Макс.     |
| T = 1 | 0.006978       | 1.647606  | 0.010346      | 1.975340  |
| T = 5 | 0.015760       | 1.840822  | 0.017944      | 1.996290  |

![Результаты для r = 0.5](task2_r_0_50.png)

**Наблюдения:**
- Численная диффузия у Годунова уменьшилась
- Осцилляции у неявной схемы остались на прежнем уровне
- Обе схемы устойчивы

#### r = 1.0 (τ = 0.1)

| Время | Схема Годунова |           | Неявная схема |           |
|-------|----------------|-----------|---------------|-----------|
|       | L1-норма       | Макс.     | L1-норма      | Макс.     |
| T = 1 | **0.000000**   | **0.000000** | 0.012188   | 2.000000  |
| T = 5 | **0.000000**   | **0.000000** | 0.024188   | 2.000003  |

![Результаты для r = 1.0](task2_r_1_00.png)

**Наблюдения:**
- **Схема Годунова дает точное решение с машинной точностью!** Это уникальное свойство схемы при r = 1
- Неявная схема по-прежнему имеет осцилляции
- Обе схемы устойчивы

#### r = 1.25 (τ = 0.125)

| Время | Схема Годунова |                | Неявная схема |           |
|-------|----------------|----------------|---------------|-----------|
|       | L1-норма       | Макс.          | L1-норма      | Макс.     |
| T = 1 | 0.056691       | 19.841858      | 0.013213      | 2.023519  |
| T = 5 | 21895.745190   | **3806047.645047** | 0.026709  | 2.010203  |

![Результаты для r = 1.25](task2_r_1_25.png)

**Наблюдения:**
- **Схема Годунова катастрофически неустойчива!** Нарушено условие Куранта
- Ошибка растет экспоненциально со временем (~10⁶ к T=5)
- Неявная схема остается устойчивой и дает разумные результаты
- Это наглядно демонстрирует разницу между условной и безусловной устойчивостью

### Сравнительный анализ

#### Зависимость ошибки от числа Куранта

| r    | Годунов (T=1) | Годунов (T=5) | Неявная (T=1) | Неявная (T=5) |
|------|---------------|---------------|---------------|---------------|
| 0.25 | 1.76          | 1.89          | 2.02          | 2.06          |
| 0.50 | 1.65          | 1.84          | 1.98          | 2.00          |
| 1.00 | **0.00**      | **0.00**      | 2.00          | 2.00          |
| 1.25 | 19.84 (!)     | 3.8×10⁶ (!)   | 2.02          | 2.01          |

#### Сравнение методов

| Критерий                 | Схема Годунова      | Неявная симметричная |
|--------------------------|---------------------|----------------------|
| Устойчивость             | r ≤ 1 (условная)    | Безусловная          |
| Порядок точности         | O(τ, h)             | O(τ, h²)             |
| Численная диффузия       | Да, сильная при r<1 | Нет                  |
| Дисперсия (осцилляции)   | Нет                 | Да, сильная          |
| Вычислительная сложность | O(N) - явная        | O(N²) - СЛАУ         |
| Точность при r = 1       | **Точное решение**  | Есть погрешность     |
| Монотонность             | Да                  | Нет                  |

### Физическая интерпретация

1. **Схема Годунова** использует информацию "против потока" (upwind), что физически корректно для гиперболических задач, где информация распространяется в определенном направлении

2. **Неявная схема** использует информацию с обеих сторон (центральная разность), что приводит к нефизичным осцилляциям

3. **Условие Куранта r ≤ 1** имеет физический смысл: за время τ информация не должна проходить расстояние больше h (пространственного шага)

4. При **r = 1** схема Годунова точно "захватывает" перемещение информации: численная сетка движется со скоростью волны

### Выводы по заданию 2

1. **Схема Годунова демонстрирует замечательное свойство:** при выполнении условия Куранта r = 1 она дает **точное решение** уравнения переноса. Это делает её идеальным выбором для задач, где можно подобрать шаг по времени.

2. **Условие устойчивости Куранта-Фридрихса-Леви критически важно** для явных схем. При r = 1.25 (превышение всего на 25%) схема Годунова становится катастрофически неустойчивой с ошибкой ~10⁶ к моменту T=5.

3. **Неявная симметричная схема безусловно устойчива**, что является её главным преимуществом. Однако она страдает от дисперсионных ошибок (осцилляции Гиббса) на разрывах, что делает её менее пригодной для задач с разрывными решениями.

4. **Выбор схемы зависит от задачи:**
   - Для задач с разрывами и возможностью подбора τ: схема Годунова с r ≈ 1
   - Для задач с жесткими ограничениями на устойчивость: неявная схема
   - Для высокоточных расчетов гладких решений: методы высоких порядков (TVD, WENO)

5. **Численная диффузия и дисперсия** — два основных типа ошибок в разностных схемах для уравнений переноса. Схема Годунова имеет диффузию, неявная — дисперсию. Полностью избежать обеих на грубых сетках невозможно, но можно минимизировать их влияние правильным выбором метода и параметров.

---

## Общее заключение

В данной работе были реализованы и детально исследованы численные методы решения дифференциальных уравнений двух типов:

### Для обыкновенных дифференциальных уравнений:

- **Метод Эйлера** (первый порядок) и **метод Рунге-Кутты** (третий порядок) показали ожидаемое соотношение точности
- **Метод Рунге** успешно применён для численной оценки порядка точности без знания точного решения
- Экспериментально подтверждены теоретические оценки: p ≈ 1 для Эйлера и p ≈ 3 для РК

### Для уравнений в частных производных (уравнение переноса):

- **Схема Годунова** продемонстрировала уникальное свойство — точное решение при r = 1 и критическую зависимость от условия Куранта
- **Неявная симметричная схема** показала безусловную устойчивость, но страдает от осцилляций на разрывах
- Наглядно продемонстрирована разница между условной и безусловной устойчивостью

### Ключевые результаты:

1. Численные эксперименты полностью подтвердили теоретические оценки порядков точности и условий устойчивости
2. Метод Рунге является надежным инструментом для оценки погрешности и порядка точности численных схем
3. Для разных типов задач оптимальны разные численные методы, и выбор схемы требует понимания природы решаемого уравнения

Работа показала важность баланса между устойчивостью, точностью и вычислительными затратами при выборе численного метода.